library(stringr)

################### read file ####################
#2018
gen_2018 <- read.csv("egrid2018_data_v2_adj.csv", sep = ",", header = TRUE)
gen_2018 <- gen_2018[-c(6:18, 22:107, 121:123, 137:139)]
gen_2018 <- gen_2018[-c(1), ]
names(gen_2018)[1] <- c("SEQ")
names(gen_2018)[2] <- c("YEAR")
names(gen_2018)[3] <- c("STATE")
names(gen_2018)[4] <- c("PLANT_NAME")
names(gen_2018)[5] <- c("ORIS_CODE")
names(gen_2018)[6] <- c("COUNTY")
names(gen_2018)[7] <- c("PLANT_LAT")
names(gen_2018)[8] <- c("PLANT_LONG")

names(gen_2018)[9] <- c("COAL_GEN")
names(gen_2018)[10] <- c("OIL_GEN")
names(gen_2018)[11] <- c("GAS_GEN")
names(gen_2018)[12] <- c("NUCLEAR_GEN")
names(gen_2018)[13] <- c("HYDRO_GEN")
names(gen_2018)[14] <- c("BIOMASS_GEN")
names(gen_2018)[15] <- c("WIND_GEN")
names(gen_2018)[16] <- c("SOLAR_GEN")
names(gen_2018)[17] <- c("GEOTHERMAL_GEN")
names(gen_2018)[18] <- c("OTHER_FOSSIL_GEN")
names(gen_2018)[19] <- c("OTHER_UNKNOWN_GEN")
names(gen_2018)[20] <- c("TOTAL_NONRENEWABLE_GEN")
names(gen_2018)[21] <- c("TOTAL_RENEWABLE_GEN")

names(gen_2018)[22] <- c("COAL_PER")
names(gen_2018)[23] <- c("OIL_PER")
names(gen_2018)[24] <- c("GAS_PER")
names(gen_2018)[25] <- c("NUCLEAR_PER")
names(gen_2018)[26] <- c("HYDRO_PER")
names(gen_2018)[27] <- c("BIOMASS_PER")
names(gen_2018)[28] <- c("WIND_PER")
names(gen_2018)[29] <- c("SOLAR_PER")
names(gen_2018)[30] <- c("GEOTHERMAL_PER")
names(gen_2018)[31] <- c("OTHER_FOSSIL_PER")
names(gen_2018)[32] <- c("OTHER_UNKNOWN_PER")
names(gen_2018)[33] <- c("TOTAL_NONRENEWABLE_PER")
names(gen_2018)[34] <- c("TOTAL_RENEWABLE_PER")


#2000
gen_2000 <- read.csv("eGRID2000_plant_adj.csv", sep = ",", header = TRUE)
gen_2000 <- gen_2000[-c(2, 6:22, 26:68, 82, 96:155)]
gen_2000 <- gen_2000[-c(1:3), ]
names(gen_2000)[1] <- c("SEQ")
names(gen_2000)[2] <- c("STATE")
names(gen_2000)[3] <- c("PLANT_NAME")
names(gen_2000)[4] <- c("ORIS_CODE")
names(gen_2000)[5] <- c("COUNTY")
names(gen_2000)[6] <- c("PLANT_LAT")
names(gen_2000)[7] <- c("PLANT_LONG")

names(gen_2000)[8] <- c("COAL_GEN")
names(gen_2000)[9] <- c("OIL_GEN")
names(gen_2000)[10] <- c("GAS_GEN")
names(gen_2000)[11] <- c("NUCLEAR_GEN")
names(gen_2000)[12] <- c("HYDRO_GEN")
names(gen_2000)[13] <- c("BIOMASS_GEN")
names(gen_2000)[14] <- c("WIND_GEN")
names(gen_2000)[15] <- c("SOLAR_GEN")
names(gen_2000)[16] <- c("GEOTHERMAL_GEN")
names(gen_2000)[17] <- c("OTHER_FOSSIL_GEN")
names(gen_2000)[18] <- c("OTHER_WASTE_GEN")
names(gen_2000)[19] <- c("TOTAL_NONRENEWABLE_GEN")
names(gen_2000)[20] <- c("TOTAL_RENEWABLE_GEN")

names(gen_2000)[21] <- c("COAL_PER")
names(gen_2000)[22] <- c("OIL_PER")
names(gen_2000)[23] <- c("GAS_PER")
names(gen_2000)[24] <- c("NUCLEAR_PER")
names(gen_2000)[25] <- c("HYDRO_PER")
names(gen_2000)[26] <- c("BIOMASS_PER")
names(gen_2000)[27] <- c("WIND_PER")
names(gen_2000)[28] <- c("SOLAR_PER")
names(gen_2000)[29] <- c("GEOTHERMAL_PER")
names(gen_2000)[30] <- c("OTHER_FOSSIL_PER")
names(gen_2000)[31] <- c("OTHER_WASTE_PER")
names(gen_2000)[32] <- c("TOTAL_NONRENEWABLE_PER")
names(gen_2000)[33] <- c("TOTAL_RENEWABLE_PER")


#2010
gen_2010 <- read.csv("eGRID2010_Data_adj.csv", sep = ",", header = TRUE)
gen_2010 <- gen_2010[-c(5:19, 23:81, 95:97, 111:165)]
gen_2010 <- gen_2010[-c(1:4), ]
names(gen_2010)[1] <- c("SEQ")
names(gen_2010)[2] <- c("STATE")
names(gen_2010)[3] <- c("PLANT_NAME")
names(gen_2010)[4] <- c("ORIS_CODE")
names(gen_2010)[5] <- c("COUNTY")
names(gen_2010)[6] <- c("PLANT_LAT")
names(gen_2010)[7] <- c("PLANT_LONG")

names(gen_2010)[8] <- c("COAL_GEN")
names(gen_2010)[9] <- c("OIL_GEN")
names(gen_2010)[10] <- c("GAS_GEN")
names(gen_2010)[11] <- c("NUCLEAR_GEN")
names(gen_2010)[12] <- c("HYDRO_GEN")
names(gen_2010)[13] <- c("BIOMASS_GEN")
names(gen_2010)[14] <- c("WIND_GEN")
names(gen_2010)[15] <- c("SOLAR_GEN")
names(gen_2010)[16] <- c("GEOTHERMAL_GEN")
names(gen_2010)[17] <- c("OTHER_FOSSIL_GEN")
names(gen_2010)[18] <- c("OTHER_UNKNOWN_GEN")
names(gen_2010)[19] <- c("TOTAL_NONRENEWABLE_GEN")
names(gen_2010)[20] <- c("TOTAL_RENEWABLE_GEN")

names(gen_2010)[21] <- c("COAL_PER")
names(gen_2010)[22] <- c("OIL_PER")
names(gen_2010)[23] <- c("GAS_PER")
names(gen_2010)[24] <- c("NUCLEAR_PER")
names(gen_2010)[25] <- c("HYDRO_PER")
names(gen_2010)[26] <- c("BIOMASS_PER")
names(gen_2010)[27] <- c("WIND_PER")
names(gen_2010)[28] <- c("SOLAR_PER")
names(gen_2010)[29] <- c("GEOTHERMAL_PER")
names(gen_2010)[30] <- c("OTHER_FOSSIL_PER")
names(gen_2010)[31] <- c("OTHER_UNKNOWN_PER")
names(gen_2010)[32] <- c("TOTAL_NONRENEWABLE_PER")
names(gen_2010)[33] <- c("TOTAL_RENEWABLE_PER")



################### Data modification ##################
#2018
gen_2018$PLANT_LAT <- as.double(gen_2018$PLANT_LAT)
gen_2018$PLANT_LONG <- as.double(gen_2018$PLANT_LONG)

gen_2018$COAL_GEN <- sub("^-", "^$", gen_2018$COAL_GEN)
gen_2018$OIL_GEN <- sub("^-", "^$", gen_2018$OIL_GEN)
gen_2018$GAS_GEN <- sub("^-", "^$", gen_2018$GAS_GEN)
gen_2018$NUCLEAR_GEN <- sub("^-", "^$", gen_2018$NUCLEAR_GEN)
gen_2018$HYDRO_GEN <- sub("^-", "^$", gen_2018$HYDRO_GEN)
gen_2018$BIOMASS_GEN <- sub("^-", "^$", gen_2018$BIOMASS_GEN)
gen_2018$WIND_GEN <- sub("^-", "^$", gen_2018$WIND_GEN)
gen_2018$SOLAR_GEN <- sub("^-", "^$", gen_2018$SOLAR_GEN)
gen_2018$GEOTHERMAL_GEN <- sub("^-", "^$", gen_2018$GEOTHERMAL_GEN)
gen_2018$OTHER_FOSSIL_GEN <- sub("^-", "^$", gen_2018$OTHER_FOSSIL_GEN)
gen_2018$OTHER_UNKNOWN_GEN <- sub("^-", "^$", gen_2018$OTHER_UNKNOWN_GEN)
gen_2018$TOTAL_NONRENEWABLE_GEN <- sub("^-", "^$", gen_2018$TOTAL_NONRENEWABLE_GEN)
gen_2018$TOTAL_RENEWABLE_GEN <- sub("^-", "^$", gen_2018$TOTAL_RENEWABLE_GEN)

gen_2018$COAL_GEN <- as.numeric(gsub(",", "", gen_2018$COAL_GEN))
gen_2018$OIL_GEN <- as.numeric(gsub(",", "", gen_2018$OIL_GEN))
gen_2018$GAS_GEN <- as.numeric(gsub(",", "", gen_2018$GAS_GEN))
gen_2018$NUCLEAR_GEN <- as.numeric(gsub(",", "", gen_2018$NUCLEAR_GEN))
gen_2018$HYDRO_GEN <- as.numeric(gsub(",", "", gen_2018$HYDRO_GEN))
gen_2018$BIOMASS_GEN <- as.numeric(gsub(",", "", gen_2018$BIOMASS_GEN))
gen_2018$WIND_GEN <- as.numeric(gsub(",", "", gen_2018$WIND_GEN))
gen_2018$SOLAR_GEN <- as.numeric(gsub(",", "", gen_2018$SOLAR_GEN))
gen_2018$GEOTHERMAL_GEN <- as.numeric(gsub(",", "", gen_2018$GEOTHERMAL_GEN))
gen_2018$OTHER_FOSSIL_GEN <- as.numeric(gsub(",", "", gen_2018$OTHER_FOSSIL_GEN))
gen_2018$OTHER_UNKNOWN_GEN <- as.numeric(gsub(",", "", gen_2018$OTHER_UNKNOWN_GEN))
gen_2018$TOTAL_NONRENEWABLE_GEN <- as.numeric(gsub(",", "", gen_2018$TOTAL_NONRENEWABLE_GEN))
gen_2018$TOTAL_RENEWABLE_GEN <- as.numeric(gsub(",", "", gen_2018$TOTAL_RENEWABLE_GEN))

gen_2018$OTHER_GEN <- (gen_2018$OTHER_FOSSIL_GEN + gen_2018$OTHER_UNKNOWN_GEN)

gen_2018$COAL_GEN <- ifelse(gen_2018$COAL_GEN == 0, NA, gen_2018$COAL_GEN)
gen_2018$OIL_GEN <- ifelse(gen_2018$OIL_GEN == 0, NA, gen_2018$OIL_GEN)
gen_2018$GAS_GEN <- ifelse(gen_2018$GAS_GEN == 0, NA, gen_2018$GAS_GEN)
gen_2018$NUCLEAR_GEN <- ifelse(gen_2018$NUCLEAR_GEN == 0, NA, gen_2018$NUCLEAR_GEN)
gen_2018$HYDRO_GEN <- ifelse(gen_2018$HYDRO_GEN == 0, NA, gen_2018$HYDRO_GEN)
gen_2018$BIOMASS_GEN <- ifelse(gen_2018$BIOMASS_GEN == 0, NA, gen_2018$BIOMASS_GEN)
gen_2018$WIND_GEN <- ifelse(gen_2018$WIND_GEN == 0, NA, gen_2018$WIND_GEN)
gen_2018$SOLAR_GEN <- ifelse(gen_2018$SOLAR_GEN == 0, NA, gen_2018$SOLAR_GEN)
gen_2018$GEOTHERMAL_GEN <- ifelse(gen_2018$GEOTHERMAL_GEN == 0, NA, gen_2018$GEOTHERMAL_GEN)
gen_2018$OTHER_FOSSIL_GEN <- ifelse(gen_2018$OTHER_FOSSIL_GEN == 0, NA, gen_2018$OTHER_FOSSIL_GEN)
gen_2018$OTHER_UNKNOWN_GEN <- ifelse(gen_2018$OTHER_UNKNOWN_GEN == 0, NA, gen_2018$OTHER_UNKNOWN_GEN)
gen_2018$TOTAL_NONRENEWABLE_GEN <- ifelse(gen_2018$TOTAL_NONRENEWABLE_GEN == 0, NA, gen_2018$TOTAL_NONRENEWABLE_GEN)
gen_2018$TOTAL_RENEWABLE_GEN <- ifelse(gen_2018$TOTAL_RENEWABLE_GEN == 0, NA, gen_2018$TOTAL_RENEWABLE_GEN)
gen_2018$OTHER_GEN <- ifelse(gen_2018$OTHER_GEN == 0, NA, gen_2018$OTHER_GEN)

#2000
gen_2000$PLANT_LAT <- as.double(gen_2000$PLANT_LAT)
gen_2000$PLANT_LONG <- as.double(gen_2000$PLANT_LONG)

gen_2000$COAL_GEN <- sub("^-", "^$", gen_2000$COAL_GEN)
gen_2000$OIL_GEN <- sub("^-", "^$", gen_2000$OIL_GEN)
gen_2000$GAS_GEN <- sub("^-", "^$", gen_2000$GAS_GEN)
gen_2000$NUCLEAR_GEN <- sub("^-", "^$", gen_2000$NUCLEAR_GEN)
gen_2000$HYDRO_GEN <- sub("^-", "^$", gen_2000$HYDRO_GEN)
gen_2000$BIOMASS_GEN <- sub("^-", "^$", gen_2000$BIOMASS_GEN)
gen_2000$WIND_GEN <- sub("^-", "^$", gen_2000$WIND_GEN)
gen_2000$SOLAR_GEN <- sub("^-", "^$", gen_2000$SOLAR_GEN)
gen_2000$GEOTHERMAL_GEN <- sub("^-", "^$", gen_2000$GEOTHERMAL_GEN)
gen_2000$OTHER_FOSSIL_GEN <- sub("^-", "^$", gen_2000$OTHER_FOSSIL_GEN)
gen_2000$OTHER_WASTE_GEN <- sub("^-", "^$", gen_2000$OTHER_WASTE_GEN)
gen_2000$TOTAL_NONRENEWABLE_GEN <- sub("^-", "^$", gen_2000$TOTAL_NONRENEWABLE_GEN)
gen_2000$TOTAL_RENEWABLE_GEN <- sub("^-", "^$", gen_2000$TOTAL_RENEWABLE_GEN)

gen_2000$COAL_GEN <- as.numeric(gsub(",", "", gen_2000$COAL_GEN))
gen_2000$OIL_GEN <- as.numeric(gsub(",", "", gen_2000$OIL_GEN))
gen_2000$GAS_GEN <- as.numeric(gsub(",", "", gen_2000$GAS_GEN))
gen_2000$NUCLEAR_GEN <- as.numeric(gsub(",", "", gen_2000$NUCLEAR_GEN))
gen_2000$HYDRO_GEN <- as.numeric(gsub(",", "", gen_2000$HYDRO_GEN))
gen_2000$BIOMASS_GEN <- as.numeric(gsub(",", "", gen_2000$BIOMASS_GEN))
gen_2000$WIND_GEN <- as.numeric(gsub(",", "", gen_2000$WIND_GEN))
gen_2000$SOLAR_GEN <- as.numeric(gsub(",", "", gen_2000$SOLAR_GEN))
gen_2000$GEOTHERMAL_GEN <- as.numeric(gsub(",", "", gen_2000$GEOTHERMAL_GEN))
gen_2000$OTHER_FOSSIL_GEN <- as.numeric(gsub(",", "", gen_2000$OTHER_FOSSIL_GEN))
gen_2000$OTHER_WASTE_GEN <- as.numeric(gsub(",", "", gen_2000$OTHER_WASTE_GEN))
gen_2000$TOTAL_NONRENEWABLE_GEN <- as.numeric(gsub(",", "", gen_2000$TOTAL_NONRENEWABLE_GEN))
gen_2000$TOTAL_RENEWABLE_GEN <- as.numeric(gsub(",", "", gen_2000$TOTAL_RENEWABLE_GEN))

gen_2000$OTHER_GEN <- (gen_2000$OTHER_FOSSIL_GEN + gen_2000$OTHER_WASTE_GEN)

gen_2000$COAL_GEN <- ifelse(gen_2000$COAL_GEN == 0, NA, gen_2000$COAL_GEN)
gen_2000$OIL_GEN <- ifelse(gen_2000$OIL_GEN == 0, NA, gen_2000$OIL_GEN)
gen_2000$GAS_GEN <- ifelse(gen_2000$GAS_GEN == 0, NA, gen_2000$GAS_GEN)
gen_2000$NUCLEAR_GEN <- ifelse(gen_2000$NUCLEAR_GEN == 0, NA, gen_2000$NUCLEAR_GEN)
gen_2000$HYDRO_GEN <- ifelse(gen_2000$HYDRO_GEN == 0, NA, gen_2000$HYDRO_GEN)
gen_2000$BIOMASS_GEN <- ifelse(gen_2000$BIOMASS_GEN == 0, NA, gen_2000$BIOMASS_GEN)
gen_2000$WIND_GEN <- ifelse(gen_2000$WIND_GEN == 0, NA, gen_2000$WIND_GEN)
gen_2000$SOLAR_GEN <- ifelse(gen_2000$SOLAR_GEN == 0, NA, gen_2000$SOLAR_GEN)
gen_2000$GEOTHERMAL_GEN <- ifelse(gen_2000$GEOTHERMAL_GEN == 0, NA, gen_2000$GEOTHERMAL_GEN)
gen_2000$OTHER_FOSSIL_GEN <- ifelse(gen_2000$OTHER_FOSSIL_GEN == 0, NA, gen_2000$OTHER_FOSSIL_GEN)
gen_2000$OTHER_WASTE_GEN <- ifelse(gen_2000$OTHER_WASTE_GEN == 0, NA, gen_2000$OTHER_WASTE_GEN)
gen_2000$TOTAL_NONRENEWABLE_GEN <- ifelse(gen_2000$TOTAL_NONRENEWABLE_GEN == 0, NA, gen_2000$TOTAL_NONRENEWABLE_GEN)
gen_2000$TOTAL_RENEWABLE_GEN <- ifelse(gen_2000$TOTAL_RENEWABLE_GEN == 0, NA, gen_2000$TOTAL_RENEWABLE_GEN)
gen_2000$OTHER_GEN <- ifelse(gen_2000$OTHER_GEN == 0, NA, gen_2000$OTHER_GEN)


#2010
gen_2010$PLANT_LAT <- as.double(gen_2010$PLANT_LAT)
gen_2010$PLANT_LONG <- as.double(gen_2010$PLANT_LONG)

gen_2010$COAL_GEN <- as.numeric(gsub(",", "", gen_2010$COAL_GEN))
gen_2010$OIL_GEN <- as.numeric(gsub(",", "", gen_2010$OIL_GEN))
gen_2010$GAS_GEN <- as.numeric(gsub(",", "", gen_2010$GAS_GEN))
gen_2010$NUCLEAR_GEN <- as.numeric(gsub(",", "", gen_2010$NUCLEAR_GEN))
gen_2010$HYDRO_GEN <- as.numeric(gsub(",", "", gen_2010$HYDRO_GEN))
gen_2010$BIOMASS_GEN <- as.numeric(gsub(",", "", gen_2010$BIOMASS_GEN))
gen_2010$WIND_GEN <- as.numeric(gsub(",", "", gen_2010$WIND_GEN))
gen_2010$SOLAR_GEN <- as.numeric(gsub(",", "", gen_2010$SOLAR_GEN))
gen_2010$GEOTHERMAL_GEN <- as.numeric(gsub(",", "", gen_2010$GEOTHERMAL_GEN))
gen_2010$OTHER_FOSSIL_GEN <- as.numeric(gsub(",", "", gen_2010$OTHER_FOSSIL_GEN))
gen_2010$OTHER_UNKNOWN_GEN <- as.numeric(gsub(",", "", gen_2010$OTHER_UNKNOWN_GEN))
gen_2010$TOTAL_NONRENEWABLE_GEN <- as.numeric(gsub(",", "", gen_2010$TOTAL_NONRENEWABLE_GEN))
gen_2010$TOTAL_RENEWABLE_GEN <- as.numeric(gsub(",", "", gen_2010$TOTAL_RENEWABLE_GEN))

gen_2010$OTHER_GEN <- (gen_2010$OTHER_FOSSIL_GEN + gen_2010$OTHER_UNKNOWN_GEN)

gen_2010$COAL_GEN <- ifelse(gen_2010$COAL_GEN == 0, NA, gen_2010$COAL_GEN)
gen_2010$OIL_GEN <- ifelse(gen_2010$OIL_GEN == 0, NA, gen_2010$OIL_GEN)
gen_2010$GAS_GEN <- ifelse(gen_2010$GAS_GEN == 0, NA, gen_2010$GAS_GEN)
gen_2010$NUCLEAR_GEN <- ifelse(gen_2010$NUCLEAR_GEN == 0, NA, gen_2010$NUCLEAR_GEN)
gen_2010$HYDRO_GEN <- ifelse(gen_2010$HYDRO_GEN == 0, NA, gen_2010$HYDRO_GEN)
gen_2010$BIOMASS_GEN <- ifelse(gen_2010$BIOMASS_GEN == 0, NA, gen_2010$BIOMASS_GEN)
gen_2010$WIND_GEN <- ifelse(gen_2010$WIND_GEN == 0, NA, gen_2010$WIND_GEN)
gen_2010$SOLAR_GEN <- ifelse(gen_2010$SOLAR_GEN == 0, NA, gen_2010$SOLAR_GEN)
gen_2010$GEOTHERMAL_GEN <- ifelse(gen_2010$GEOTHERMAL_GEN == 0, NA, gen_2010$GEOTHERMAL_GEN)
gen_2010$OTHER_FOSSIL_GEN <- ifelse(gen_2010$OTHER_FOSSIL_GEN == 0, NA, gen_2010$OTHER_FOSSIL_GEN)
gen_2010$OTHER_UNKNOWN_GEN <- ifelse(gen_2010$OTHER_UNKNOWN_GEN == 0, NA, gen_2010$OTHER_UNKNOWN_GEN)
gen_2010$TOTAL_NONRENEWABLE_GEN <- ifelse(gen_2010$TOTAL_NONRENEWABLE_GEN == 0, NA, gen_2010$TOTAL_NONRENEWABLE_GEN)
gen_2010$TOTAL_RENEWABLE_GEN <- ifelse(gen_2010$TOTAL_RENEWABLE_GEN == 0, NA, gen_2010$TOTAL_RENEWABLE_GEN)
gen_2010$OTHER_GEN <- ifelse(gen_2010$OTHER_GEN == 0, NA, gen_2010$OTHER_GEN)


######################## input list ##########################
energySource_dist <- c("Select All", "Select Renewable", "Select nonRenewable", "Coal", "Oil", "Gas", "Nuclear", "Hydro", "Biomass", "Wind", "Solar", "Geothermal", "Other")


